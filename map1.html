<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<head>
    <meta charset="utf-8">
    <title>Interactive Web Mapping</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.5.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.5.0/mapbox-gl.js"></script>
    <style>
      body {
        margin: 0;
        padding: 0;
      }

      #map {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 100%;
      }
    </style>
</head>
  <title>Document</title>
</head>

//one is a choropleth map of the covid-19 rates
<body>
  <div id = "map"></div>

    <div class='map-overlay' id='features'>
        <h2>Choropleth map of covid-19 rates</h2>
        <div id='text-description'>
            <p>Hover over the state</p>
        </div>
    </div>
  <div class='map-overlay' id='legend'>
  </div>
  <script>
     mapboxgl.accessToken =
            'pk.eyJ1Ijoia25lbDIiLCJhIjoiY21rdTlkYmx5MThyZjNmcHVrMDYzdXJ4dyJ9.HrXpvWOlXxo7fGCGnGQG6A';
        let map = new mapboxgl.Map({
            container: 'map', // container ID
            style: 'mapbox://styles/mapbox/dark-v10',
            projection: 'albers',
            zoom: 5,
            minZoom: 4,
            center: [-96, 37]
        });

    async function geojsonFetch() {
    // other operations
    }

    geojsonFetch();

    let response = await fetch('assets/us-covid-2020-rates.json');
    let stateData = await response.json();

    // map.on('load', function loadingData() {
    // // add layer
    // // add legend
    // });
//   map.addSource('stateData', {
//     type: 'geojson',
//     data: stateData
// });
    map.addSource('rateData', {
    type: 'geojson',
    data: 'assets/us-covid-2020-rates.json'
});

map.addLayer({
    'id': 'rate-Data-layer',
    'type': 'fill',
    'source': 'rate-data',
    'paint': {
        'fill-color': [
            'step',
            ['get', 'density'],
            '#FFEDA0',   // stop_output_0
            10,          // stop_input_0
            '#FED976',   // stop_output_1
            20,          // stop_input_1
            '#FEB24C',   // stop_output_2
            50,          // stop_input_2
            '#FD8D3C',   // stop_output_3
            100,         // stop_input_3
            '#FC4E2A',   // stop_output_4
            200,         // stop_input_4
            '#E31A1C',   // stop_output_5
            500,         // stop_input_5
            '#BD0026',   // stop_output_6
            1000,        // stop_input_6
            "#800026"    // stop_output_7
        ],
        'fill-outline-color': '#BBBBBB',
        'fill-opacity': 0.7,
    }
});

const legend = document.getElementById('legend');
legend.innerHTML = "<b>Population Density<br>(people/sq.mi.)</b><br><br>";

layers.forEach((layer, i) => {
    const color = colors[i];
    const item = document.createElement('div');
    const key = document.createElement('span');
    key.className = 'legend-key';
    key.style.backgroundColor = color;

    const value = document.createElement('span');
    value.innerHTML = `${layer}`;
    item.appendChild(key);
    item.appendChild(value);
    legend.appendChild(item);
});

  </script>
</body>
</html>